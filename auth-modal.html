<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZenTrade - Authentication</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#00F5D4',
                        'primary-dark': '#00D4B8',
                        'card-dark': '#1A2332',
                        'text-primary': '#FFFFFF',
                        'text-secondary': '#B0BEC5',
                        'profit-green': '#00E676',
                        'loss-red': '#FF5252',
                        'warning-amber': '#FFB74D'
                    },
                    fontFamily: {
                        'sans': ['Inter', 'system-ui', 'sans-serif']
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                        'glow': 'glow 2s ease-in-out infinite alternate'
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0px)' },
                            '50%': { transform: 'translateY(-20px)' }
                        },
                        glow: {
                            '0%': { boxShadow: '0 0 20px rgba(0, 245, 212, 0.3)' },
                            '100%': { boxShadow: '0 0 30px rgba(0, 245, 212, 0.6)' }
                    }
                }
            }
        }
    </script>
    <style>
        .glass-effect {
            background: rgba(26, 35, 50, 0.8);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 min-h-screen flex items-center justify-center p-4">
    <div class="glass-effect rounded-2xl p-8 w-full max-w-md">
        <!-- Logo -->
        <div class="text-center mb-8">
            <div class="inline-flex items-center gap-3 mb-4">
                <div class="w-12 h-12 bg-gradient-to-br from-primary to-primary-dark rounded-xl flex items-center justify-center">
                    <span class="text-2xl font-bold text-slate-900">Z</span>
                </div>
                <h1 class="text-3xl font-bold text-text-primary">ZenTrade</h1>
            </div>
            <p class="text-text-secondary">Professional Trading Journal</p>
        </div>

        <!-- Error Message -->
        <div id="authError" class="hidden bg-red-500/20 border border-red-500/30 text-red-400 px-4 py-3 rounded-lg mb-6 text-sm">
        </div>

        <!-- Login Form -->
        <form id="loginForm" class="space-y-6">
            <div>
                <h2 class="text-2xl font-bold text-text-primary mb-2">Welcome Back</h2>
                <p class="text-text-secondary">Sign in to your trading journal</p>
            </div>

            <div>
                <label for="loginEmail" class="block text-sm font-medium text-text-primary mb-2">Email</label>
                <input type="email" id="loginEmail" required
                       class="w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-text-primary placeholder-text-secondary focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20">
            </div>

            <div>
                <label for="loginPassword" class="block text-sm font-medium text-text-primary mb-2">Password</label>
                <input type="password" id="loginPassword" required
                       class="w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-text-primary placeholder-text-secondary focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20">
            </div>

            <button type="submit" 
                    class="w-full bg-gradient-to-r from-primary to-primary-dark text-slate-900 font-semibold py-3 px-6 rounded-lg hover:from-primary-dark hover:to-primary transition-all duration-200 transform hover:scale-105">
                Sign In
            </button>

            <div class="text-center">
                <p class="text-text-secondary">Don't have an account? 
                    <button type="button" onclick="switchToRegister()" class="text-primary hover:text-primary-dark font-medium">
                        Sign up
                    </button>
                </p>
            </div>
        </form>

        <!-- Register Form -->
        <form id="registerForm" class="space-y-6 hidden">
            <div>
                <h2 class="text-2xl font-bold text-text-primary mb-2">Create Account</h2>
                <p class="text-text-secondary">Start your trading journey</p>
            </div>

            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label for="registerFirstName" class="block text-sm font-medium text-text-primary mb-2">First Name</label>
                    <input type="text" id="registerFirstName" required
                           class="w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-text-primary placeholder-text-secondary focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20">
                </div>
                <div>
                    <label for="registerLastName" class="block text-sm font-medium text-text-primary mb-2">Last Name</label>
                    <input type="text" id="registerLastName" required
                           class="w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-text-primary placeholder-text-secondary focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20">
                </div>
            </div>

            <div>
                <label for="registerEmail" class="block text-sm font-medium text-text-primary mb-2">Email</label>
                <input type="email" id="registerEmail" required
                       class="w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-text-primary placeholder-text-secondary focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20">
            </div>

            <div>
                <label for="registerPassword" class="block text-sm font-medium text-text-primary mb-2">Password</label>
                <input type="password" id="registerPassword" required minlength="6"
                       class="w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-text-primary placeholder-text-secondary focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20">
                <p class="text-xs text-text-secondary mt-1">Minimum 6 characters</p>
            </div>

            <button type="submit" 
                    class="w-full bg-gradient-to-r from-primary to-primary-dark text-slate-900 font-semibold py-3 px-6 rounded-lg hover:from-primary-dark hover:to-primary transition-all duration-200 transform hover:scale-105">
                Create Account
            </button>

            <div class="text-center">
                <p class="text-text-secondary">Already have an account? 
                    <button type="button" onclick="switchToLogin()" class="text-primary hover:text-primary-dark font-medium">
                        Sign in
                    </button>
                </p>
            </div>
        </form>

        <!-- Loading Spinner -->
        <div id="loadingSpinner" class="hidden text-center">
            <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div>
            <p class="text-text-secondary mt-2">Processing...</p>
        </div>
    </div>

    <script src="js/auth.js"></script>
    <script>
        // Form switching
        function switchToRegister() {
            document.getElementById('loginForm').classList.add('hidden');
            document.getElementById('registerForm').classList.remove('hidden');
            AuthUI.hideError();
        }

        function switchToLogin() {
            document.getElementById('registerForm').classList.add('hidden');
            document.getElementById('loginForm').classList.remove('hidden');
            AuthUI.hideError();
        }

        // Show loading
        function showLoading() {
            document.getElementById('loginForm').classList.add('hidden');
            document.getElementById('registerForm').classList.add('hidden');
            document.getElementById('loadingSpinner').classList.remove('hidden');
        }

        // Hide loading
        function hideLoading() {
            document.getElementById('loadingSpinner').classList.add('hidden');
        }

        // Login form submission
        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            showLoading();
            AuthUI.hideError();

            try {
                const email = document.getElementById('loginEmail').value;
                const password = document.getElementById('loginPassword').value;

                await window.authManager.login(email, password);
                
                // Redirect to dashboard
                window.location.href = 'http://localhost:8000/index.html';
            } catch (error) {
                hideLoading();
                document.getElementById('loginForm').classList.remove('hidden');
                AuthUI.showError(error.message);
            }
        });

        // Register form submission
        document.getElementById('registerForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            showLoading();
            AuthUI.hideError();

            try {
                const userData = {
                    firstName: document.getElementById('registerFirstName').value,
                    lastName: document.getElementById('registerLastName').value,
                    email: document.getElementById('registerEmail').value,
                    password: document.getElementById('registerPassword').value
                };

                await window.authManager.register(userData);
                
                // Redirect to dashboard
                window.location.href = 'http://localhost:8000/index.html';
            } catch (error) {
                hideLoading();
                document.getElementById('registerForm').classList.remove('hidden');
                AuthUI.showError(error.message);
            }
        });

        // Check if already authenticated
        if (window.authManager.isAuthenticated()) {
            window.location.href = 'index.html';
        }
    </script>
</body>
</html>
